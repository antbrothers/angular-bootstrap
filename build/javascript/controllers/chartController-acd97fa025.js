"use strict";var myControllers=angular.module("chartController",[]);myControllers.controller("chartCtrl",["$scope","chartService","$location",function(e,t,a){console.log("chartCtrl"),e.date=new Date,e.year=e.date.getFullYear(),e.mouth=e.date.getMonth()+1,e.carNumber="",e.param=a.search(),e.userId=e.param.userId;var r={chart:{renderTo:"Chart",defaultSeriesType:"pie"},title:{text:""},colors:["#fed978","#f9c75d","#88daf6","#67c7ee","#91ded0","#5eccb6"],plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{format:"<b>{point.name}</b><br>￥{point.y:.2f}"}}},tooltip:{headerFormat:'<span style="font-size:11px;display: none"></span>',pointFormat:'<span style="color:{point.color}">{point.name}</span>: ￥<b>{point.y:.2f}<br/>'},credits:{enabled:!1},series:[{type:"pie",name:"",data:[]}]},o={title:{text:""},xAxis:{categories:[]},colors:["#f9c75d","#67c7ee","#5eccb6"],yAxis:{title:{text:""},plotLines:[{value:0,width:1,color:"#808080"}]},tooltip:{pointFormat:'<tr><td style="color: {series.color}">{series.name}: </td><td style="text-align: right"><b>￥{point.y:.1f}</b></td></tr>'},legend:{layout:"horizontal",align:"center",verticalAlign:"top",borderWidth:0},credits:{enabled:!1},series:[]},n={chart:{type:"column"},title:{text:""},xAxis:{categories:[]},yAxis:[{min:0,title:{text:""}},{title:{text:""},opposite:!0}],credits:{enabled:!1},legend:{shadow:!1},tooltip:{shared:!0,pointFormat:"{series.name}:￥<b>{point.y:.1f}</b>"},plotOptions:{column:{grouping:!1,shadow:!1,borderWidth:0}},series:[{name:"预期",color:"#fed978",data:[],pointPadding:.3,pointPlacement:-.2},{name:"实际",color:"#88daf6",data:[],pointPadding:.4,pointPlacement:-.2}]};t.getChartPie(e.userId).success(function(t){if("0"==t.errorNum){e.todayDesc=t.data.todayDesc,e.todayIncome=t.data.todayIncome,e.freeRelease=t.data.freeRelease,e.remit=t.data.remit;for(var a=0;a<t.data.dayStatisticsMap.length;a++){var o=[];o.push(""+t.data.dayStatisticsMap[a].desc,parseInt(t.data.dayStatisticsMap[a].value)),r.series[0].data.push(o)}}$("#container").highcharts(r)}).error(function(){$.helpTool().errorWarning("",{desc:"服务器繁忙"})}),t.getLineData(e.userId).success(function(t){if("0"==t.errorNum){e.weekDesc=t.data.weekDesc,e.weekDate=t.data.weekDate;for(var a=0;a<t.data.xAxis.length;a++)o.xAxis.categories.push(t.data.xAxis[a]);for(var r=0;r<t.data.dayStatisticsMap.length;r++)o.series.push(t.data.dayStatisticsMap[r])}console.log(o.xAxis.categories),$("#line_container").highcharts(o)}).error(function(){$.helpTool().errorWarning("",{desc:"服务器繁忙"})}),t.getColumnData(e.year,e.mouth,e.userId).success(function(t){if("0"==t.errorNum){e.monthly=t.data.monthly,e.monthtime=t.data.monthtime;for(var a=0;a<t.data.xAxis.length;a++)n.xAxis.categories.push(t.data.xAxis[a]);for(var r=0;r<t.data.dayStatisticsMap.length;r++)n.series[0].data.push(t.data.dayStatisticsMap[r]);for(var o=0;o<t.data.factPrice.length;o++)n.series[1].data.push(t.data.factPrice[o])}$("#column_container").highcharts(n)}).error(function(){$.helpTool().errorWarning("",{desc:"服务器繁忙"})}),e.fangXing=function(){""==e.carNumber?$.helpTool().errorWarning("",{desc:"请输入车牌号"}):7!=e.carNumber.length?$.helpTool().errorWarning("",{desc:"请输入正确的车牌号"}):t.getClearance(e.userId,e.carNumber).success(function(e){"0"==e.errorNum?layer.open({content:e.errorInfo,btn:["确认"]}):layer.open({content:e.errorInfo,btn:["确认"]})}).error(function(){$.helpTool().errorWarning("",{desc:"服务器繁忙"})})}}]);