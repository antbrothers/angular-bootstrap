"use strict";var myControllers=angular.module("registerController",[]);myControllers.controller("registerCtrl",["$scope","$stateParams","registerService","$location","localStorageService",function(e,r,o,t,n){console.log("注册");var s=60;clearInterval(window.timeId);var a=t.search();e.returnType=t.search().type,e.openId={},o.getOpenId(a.code).success(function(r){e.openId=r.openId}).error(function(){}),e.register=function(r,t,s){if($.helpTool().checkMobile(r,t)){if(""==s||void 0==s)return $.helpTool().errorWarning("",{desc:"请输入验证码"}),!1;o.register(r,t,s,e.openId).success(function(r){console.log(r),"0"!=r.errorNum?$.helpTool().errorWarning("#error_show",{desc:r.errorInfo}):(n.set("userWxOpenIdSixThree",e.openId),n.set("userWxCustomerIdSixThree",r.customerId),e.userWxOpenIdSixThree=n.get("userWxOpenIdSixThree"),e.userWxCustomerIdSixThree=n.get("userWxCustomerIdSixThree"),"boxiang"!=e.returnType?"temporary"==e.returnType?(e.encodeuri=encodeURI("http://p-share.cn/wx_share/wxpay/getAuthor?backUri=http://p-share.cn/wx_share/wxpay/getCode?directUrl=http://www.p-share.com/wx_share/html5/templates/temporary.html"),window.location.href=e.encodeuri):(e.encodeuri=encodeURI("http://p-share.cn/wx_share/wxpay/getAuthor?backUri=http://p-share.cn/wx_share/wxpay/getCode?directUrl=http://p-share.cn/wx_share/html5/views/index.html%23/home/"+e.returnType),window.location.href=e.encodeuri):(e.encodeuri=encodeURI("http://p-share.cn/wx_share/wxpay/getAuthor?backUri=http://p-share.cn/wx_share/wxpay/getCode?directUrl=http://www.p-share.com/wx_share/html5/templates/temporary.html"),window.location.href=e.encodeuri))}).error(function(e){console.log("注册失败"),$.helpTool().errorWarning("#error_show",{desc:e.errorInfo})})}},e.getCode=function(e){$.helpTool().checkMobile(e,"123456")&&($(".get_yanm").attr("disabled",!0),o.getCode(e).success(function(e){"0"!=e.errorNum&&$.helpTool().errorWarning("#error_show",{desc:"获取验证码失败"}),window.timeId=setInterval(function(){0==s?($(".get_yanm").attr("disabled",!1),$(".get_yanm").text("获取验证码").css("background-color","#3AD5B8"),clearInterval(window.timeId),s=60):($(".get_yanm").attr("disabled",!0),$(".get_yanm").text("重新获取("+s+")").css("background-color","#CBC9C9"),s--)},1e3),console.log(timeId)}).error(function(){$(".get_yanm").attr("disabled",!1),$.helpTool().errorWarning("#error_show",{desc:"获取验证码失败"})}))}}]);