"use strict";var myControllers=angular.module("reservedPayOrderControllers",[]);myControllers.controller("reservedPayOrderCtrl",["$scope","$timeout","$stateParams","paySuccessService","$location",function(r,e,o,t,a){console.log("优惠停车凭证"),r.orderId=a.search().orderId,r.orderType=a.search().orderType;var n=4;clearInterval(window.timeId),r.timeCount=function(){window.timeId=setInterval(function(){1==n?(angular.element(".useImg").attr("src","../images/unused_d.png"),n=4):2==n?(angular.element(".useImg").attr("src","../images/unused_c.png"),n--):3==n?(angular.element(".useImg").attr("src","../images/unused_b.png"),n--):4==n&&(angular.element(".useImg").attr("src","../images/unused_a.png"),n--)},500)},t.orderdetail(r.orderId,r.orderType).success(function(e){if("0"==e.errorNum)if(console.log(e),"13"==r.orderType||"14"==r.orderType)r.lt=!0,r.data=e.order,r.carNumberStr=[e.order.carNumber.substring(0,2),e.order.carNumber.substring(2,7)];else{r.lt=!1,r.data=e.order,r.carNumberStr=[e.order.carNumber.substring(0,2),e.order.carNumber.substring(2,7)],"0"==e.order.voucherStatus&&r.timeCount();var o=r.toUtf8(""+e.order.orderId);angular.element("#code").qrcode({render:"canvas",width:80,height:80,text:o});var t={barWidth:1,barHeight:60};angular.element("#barcodeTarget").barcode(o,"code128",t)}else $.helpTool().errorWarning("",{desc:e.errorInfo})}).error(function(){$.helpTool().errorWarning("",{desc:"请求服务器失败"})}),r.toUtf8=function(r){var e,o,t,a;for(e="",t=r.length,o=0;t>o;o++)a=r.charCodeAt(o),a>=1&&127>=a?e+=r.charAt(o):a>2047?(e+=String.fromCharCode(224|a>>12&15),e+=String.fromCharCode(128|a>>6&63),e+=String.fromCharCode(128|a>>0&63)):(e+=String.fromCharCode(192|a>>6&31),e+=String.fromCharCode(128|a>>0&63));return e}}]);